# 语音服务配置指南

## 🎙️ 为什么需要专业 TTS 服务？

浏览器内置的 Web Speech API 存在以下问题：
- ❌ 所有口音听起来都一样
- ❌ 声音机械，不自然
- ❌ 不同浏览器表现不一致
- ❌ 部分浏览器不支持

专业 TTS 服务的优势：
- ✅ 真实的人声，非常自然
- ✅ 不同口音有明显区别
- ✅ 高质量音频
- ✅ 跨平台一致性

---

## 🌟 推荐方案：ElevenLabs（最佳）

### 为什么选择 ElevenLabs？

1. **最自然的人声**
   - 使用 AI 生成，接近真人
   - 情感丰富，语调自然
   - 停顿和节奏符合真实对话

2. **明显的口音区别**
   - 美式口音：清晰标准
   - 英式口音：优雅正式
   - 印度口音：独特韵律
   - 澳洲口音：轻松友好

3. **多种声音人物**
   - Rachel：专业美式女声
   - Josh：成熟美式男声
   - Dorothy：优雅英式女声
   - Daniel：权威英式男声

4. **免费额度**
   - 每月 10,000 字符免费
   - 约可生成 100-150 道题目的语音
   - 适合个人和小规模使用

---

## 📝 配置步骤

### 方案一：ElevenLabs（推荐）

#### 1. 注册账号

访问：https://elevenlabs.io/

- 使用邮箱注册（免费）
- 验证邮箱
- 登录控制台

#### 2. 获取 API Key

1. 进入个人中心：https://elevenlabs.io/speech-synthesis
2. 点击右上角头像 → Profile
3. 找到 "API Key" 部分
4. 点击 "Copy" 复制 API Key

#### 3. 配置环境变量

```bash
# 编辑 .env 文件
nano .env

# 添加以下内容
ELEVENLABS_API_KEY=your-api-key-here
```

#### 4. 重启应用

```bash
# 如果使用 Docker
docker-compose restart

# 如果使用 npm
# 按 Ctrl+C 停止，然后重新启动
npm run dev
```

#### 5. 测试

1. 访问 http://localhost:3000
2. 登录并开始新面试
3. 选择不同的口音
4. 点击 "Play Question" 播放
5. 现在应该能听到明显不同的声音！

---

### 方案二：OpenAI TTS（备选）

#### 优点
- 质量很好，自然度高
- 如果已有 OpenAI API，无需额外注册
- 支持多种声音

#### 缺点
- 收费（按字符计费）
- 口音差异不如 ElevenLabs 明显

#### 配置步骤

```bash
# 在 .env 中添加
OPENAI_API_KEY=sk-your-api-key-here
```

**可用声音**：
- `alloy` - 中性，友好
- `echo` - 温暖，男性化
- `fable` - 戏剧性，英式
- `onyx` - 深沉，男性化
- `nova` - 活泼，女性化
- `shimmer` - 柔和，女性化

---

### 方案三：Azure Speech（企业级）

#### 优点
- 企业级稳定性
- 支持最多语言和口音
- 详细的语音控制

#### 缺点
- 配置复杂
- 需要 Azure 账户
- 收费

#### 配置步骤

```bash
# 在 .env 中添加
AZURE_SPEECH_KEY=your-azure-key
AZURE_SPEECH_REGION=eastus
```

---

## 🎯 当前配置的声音

### 使用 ElevenLabs 的声音

| 口音 | 角色名 | Voice ID | 特点 |
|------|--------|----------|------|
| 美式英语（女）| Rachel | 21m00Tcm4TlvDq8ikWAM | 标准美式，专业友好 |
| 美式英语（男）| Josh | TxGEqnHWrfWFTfGW9XjX | 深沉稳重，成熟 |
| 英式英语（女）| Dorothy | ThT5KcBeYPX3keUQqHPh | 纯正英式，优雅 |
| 英式英语（男）| Daniel | onwK4e9ZLuTAKqWW03F9 | 权威专业，正式 |

### 使用 OpenAI 的声音

| 口音 | 角色名 | Voice ID | 特点 |
|------|--------|----------|------|
| 印度英语（女）| Priya | shimmer | 温和亲切，印度口音 |
| 印度英语（男）| Raj | onyx | 深沉严肃，印度口音 |
| 澳洲英语（女）| Sophie | nova | 轻松自然，澳洲口音 |

---

## 💰 费用对比

### ElevenLabs

**免费套餐**：
- 10,000 字符/月
- 约 150 道题目
- 适合个人使用

**付费套餐**：
- Starter: $5/月，30,000 字符
- Creator: $22/月，100,000 字符
- Pro: $99/月，500,000 字符

### OpenAI TTS

**按使用付费**：
- $0.015 / 1000 字符（TTS-1）
- $0.030 / 1000 字符（TTS-1-HD，推荐）

**示例**：
- 1000 道题目 ≈ 50,000 字符
- 费用：$1.5（TTS-1-HD）

### Azure Speech

**免费额度**：
- 500,000 字符/月（前 12 个月）
- 之后：5,000,000 字符/月

**付费**：
- 标准：$1 / 1M 字符
- 神经语音：$16 / 1M 字符

---

## 🔍 声音对比示例

### 同一句话的不同口音

**问题**: "Why do you want to visit the United States?"

**美式英语（Rachel - ElevenLabs）**：
- 发音：/waɪ duː juː wɑːnt tuː ˈvɪzɪt ðə juːˈnaɪtɪd steɪts/
- 特点：清晰、标准、r 音明显
- 适合：标准面试场景

**英式英语（Dorothy - ElevenLabs）**：
- 发音：/waɪ duː juː wɒnt tuː ˈvɪzɪt ðə juːˈnaɪtɪd steɪts/
- 特点：优雅、正式、省略 r 音
- 适合：英国签证面试

**印度英语（Shimmer - OpenAI）**：
- 发音：带有印度口音的节奏和韵律
- 特点：独特的重音模式
- 适合：模拟印度签证官

**澳洲英语（Nova - OpenAI）**：
- 发音：带有澳洲特色的元音
- 特点：轻松、友好
- 适合：澳洲签证面试

---

## 🎮 使用体验

### 配置前（浏览器 TTS）
```
所有口音 → 机械的 AI 朗读声 → 无法区分
```

### 配置后（ElevenLabs）
```
美式（Rachel）  → 专业美式女声 → 听起来像真实面试官
英式（Dorothy）  → 优雅英式女声 → 完全不同的口音
印度（Shimmer）  → 独特印度口音 → 明显的文化特征
澳洲（Nova）     → 轻松澳洲口音 → 独特的发音风格
```

---

## 🚀 快速开始

### 1 分钟配置（推荐）

```bash
# 1. 注册 ElevenLabs（免费）
open https://elevenlabs.io/

# 2. 获取 API Key
# 登录 → Profile → Copy API Key

# 3. 配置
echo "ELEVENLABS_API_KEY=your-key-here" >> .env

# 4. 重启
docker-compose restart
# 或
npm run dev

# 5. 测试
# 访问 http://localhost:3000
# 开始面试 → 播放问题 → 享受真实的声音！
```

---

## 🔧 故障排查

### 问题 1：听到的还是机械声音

**原因**：API Key 未配置或配置错误

**解决**：
```bash
# 检查 .env 文件
cat .env | grep ELEVENLABS

# 确保格式正确
ELEVENLABS_API_KEY=your-actual-key-here

# 重启应用
docker-compose restart
```

### 问题 2：播放失败

**原因**：API 配额用完或网络问题

**解决**：
1. 检查 ElevenLabs 控制台配额
2. 检查网络连接
3. 查看浏览器控制台错误信息

### 问题 3：声音延迟

**原因**：首次生成需要时间

**解决**：
- 正常现象，首次播放需要 1-3 秒生成
- 可以预加载音频（未来功能）

### 问题 4：API Key 无效

**错误信息**：`ElevenLabs API error: 401`

**解决**：
1. 确认 API Key 是否正确
2. 确认账号是否激活
3. 重新复制 API Key

---

## 📊 推荐配置

### 个人学习（推荐）

```bash
# 使用 ElevenLabs 免费套餐
ELEVENLABS_API_KEY=your-key-here

# 每月 10,000 字符
# 约 150 道题目的语音
# 完全免费
```

### 培训机构（推荐）

```bash
# 方案 1: ElevenLabs Creator 套餐
ELEVENLABS_API_KEY=your-key-here
# $22/月，100,000 字符
# 约 1,500 道题目

# 方案 2: OpenAI TTS
OPENAI_API_KEY=sk-your-key-here
# 按使用付费，成本可控
# 1000 题约 $1.5
```

### 企业应用

```bash
# 使用 Azure Speech
AZURE_SPEECH_KEY=your-key
AZURE_SPEECH_REGION=eastus

# 每月 500 万字符免费
# 稳定性最好
# 支持最多功能
```

---

## 🎯 最佳实践

### 1. 混合使用

```bash
# 美式/英式使用 ElevenLabs（最自然）
ELEVENLABS_API_KEY=your-key

# 印度/澳洲使用 OpenAI（成本低）
OPENAI_API_KEY=your-key
```

### 2. 预算控制

- 设置 ElevenLabs 月度限额
- 监控 API 使用量
- 使用 OpenAI 作为备选

### 3. 音质优化

- 使用 `tts-1-hd` 模型（OpenAI）
- 使用 `eleven_monolingual_v1` 模型（ElevenLabs）
- 调整 `stability` 和 `similarity_boost` 参数

---

## 📞 获取支持

### ElevenLabs
- 文档：https://docs.elevenlabs.io/
- Discord：https://discord.gg/elevenlabs
- 邮件：support@elevenlabs.io

### OpenAI
- 文档：https://platform.openai.com/docs/guides/text-to-speech
- 社区：https://community.openai.com/

### Azure
- 文档：https://docs.microsoft.com/azure/cognitive-services/speech-service/

---

## ✅ 配置检查清单

- [ ] 已注册 TTS 服务账号
- [ ] 已获取 API Key
- [ ] 已添加到 .env 文件
- [ ] 已重启应用
- [ ] 已测试播放功能
- [ ] 能听到不同口音的明显区别
- [ ] 声音自然，不机械

---

**配置完成后，你将获得真实的、有区别的签证官声音！** 🎉

每种口音都有独特的特征，完全模拟真实面试场景。
